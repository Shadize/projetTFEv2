"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[839],{7461:(M,u,r)=>{r.d(u,{lm:()=>t,L7:()=>l,A2:()=>i});var t=function(e){return e.DETAIL="DETAIL",e.EDIT="EDIT",e.DELETE="DELETE",e.ADD="ADD",e.LOGOUT="LOGOUT",e}(t||{}),i=function(e){return e.USERNAME="username",e.PASSWORD="password",e.MAIL="mail",e.ISADMIN="isAdmin",e.FIRSTNAME="firstname",e.LASTNAME="lastname",e.SECTION="section",e}(i||{}),l=function(e){return e.TRUE="true",e.FALSE="false",e}(l||{})},4539:(M,u,r)=>{r.d(u,{k:()=>T});var t=r(4438),i=r(177),l=r(3834),e=r(9417),g=r(8994),p=r(8141),m=r(4842),O=r(382);const n=o=>({count:o});function f(o,C){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"labelWithParam"),t.k0s()),2&o){const c=t.XpG(2);t.R7$(),t.JRh(t.bMT(2,1,c.apiError()))}}function a(o,C){if(1&o&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"labelWithParam"),t.k0s()),2&o){const c=C.$implicit,h=t.XpG(2);t.R7$(),t.SpI(" ",t.i5U(2,1,"security-feature.sign-in-page.error."+c.control+"-"+c.error,t.eq3(4,n,h.errors().length))," ")}}function s(o,C){if(1&o&&(t.j41(0,"div",6),t.DNE(1,f,3,3,"p",7)(2,a,3,6,"p",5),t.k0s()),2&o){const c=t.XpG();t.R7$(),t.Y8G("ngIf",c.apiError()),t.R7$(),t.Y8G("ngForOf",c.errors())}}function v(o,C){if(1&o){const c=t.RV6();t.j41(0,"div",12),t.bIt("click",function(){t.eBV(c);const _=t.XpG(2);return t.Njj(_.signIn())}),t.nrm(1,"i"),t.k0s()}if(2&o){const c=t.XpG(2);t.AVh("un-clickable",!c.formGroup.valid),t.R7$(),t.HbH(c.iconBtn)}}function E(o,C){1&o&&t.nrm(0,"div",13)}function d(o,C){if(1&o&&(t.qex(0),t.j41(1,"div",8),t.nrm(2,"app-floating-label-input",9),t.DNE(3,v,2,4,"div",10),t.k0s(),t.DNE(4,E,1,0,"div",11),t.bVm()),2&o){const c=C.$implicit,h=C.last,_=t.XpG();t.R7$(2),t.Y8G("label",c.label)("control",_.get(c.input))("type",c.inputType),t.R7$(),t.Y8G("ngIf",h),t.R7$(),t.Y8G("ngIf",!h)}}let T=(()=>{class o{constructor(){this.title="security-feature.sign-in-page.title",this.iconBtn="fa-solid fa-unlock",this.formType=O.O.SIGN_IN,this.destroyRef=(0,t.WQX)(t.abz),this.securityService=(0,t.WQX)(g.i),this.errors=(0,t.vPA)([]),this.apiError=(0,t.vPA)(null)}ngOnInit(){this.initFormGroup()}signIn(){this.formGroup.valid&&(this.formType===O.O.SIGN_IN?this.securityService.signIn(this.formGroup.value):this.securityService.signUp(this.formGroup.value)).pipe((0,p.M)(h=>{h.result||this.apiError.set(h.code)})).subscribe()}get(c){return this.formGroup.get(c)}initFormGroup(){this.formGroup=(0,l.V)(this.formGroupControls),(0,l.NC)(this.formGroup,this.errors,this.destroyRef)}static#t=this.\u0275fac=function(h){return new(h||o)};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-security-form"]],inputs:{formGroupControls:"formGroupControls",title:"title",iconBtn:"iconBtn",formType:"formType"},standalone:!0,features:[t.aNF],decls:13,vars:6,consts:[["id","wrapper",3,"formGroup"],["id","logo"],[1,"fa-light","fa-cube"],["class","error-area",4,"ngIf"],[1,"form-area"],[4,"ngFor","ngForOf"],[1,"error-area"],[4,"ngIf"],[1,"input"],[3,"label","control","type"],["class","icon",3,"un-clickable","click",4,"ngIf"],["class","separator",4,"ngIf"],[1,"icon",3,"click"],[1,"separator"]],template:function(h,_){1&h&&(t.nrm(0,"header"),t.j41(1,"section",0)(2,"div",1),t.nrm(3,"i",2),t.j41(4,"h1"),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.DNE(7,s,3,2,"div",3),t.j41(8,"div",4),t.DNE(9,d,5,5,"ng-container",5),t.k0s()(),t.j41(10,"footer")(11,"p"),t.EFF(12,"Copyright \xa9 2023 Institut Notre-Dame de Malmedy Tous droits r\xe9serv\xe9s."),t.k0s()()),2&h&&(t.R7$(),t.Y8G("formGroup",_.formGroup),t.R7$(4),t.JRh(t.bMT(6,4,_.title)),t.R7$(2),t.Y8G("ngIf",_.errors().length>0||_.apiError()),t.R7$(2),t.Y8G("ngForOf",_.formGroupControls))},dependencies:[i.MD,i.Sq,i.bT,l.sJ,l.Sd,e.X1,e.cb,e.j4,m.h,m.D9],styles:["[_nghost-%COMP%]{min-height:100vh;display:flex;flex-direction:column}header[_ngcontent-%COMP%]{flex:1}section[_ngcontent-%COMP%]{flex:3;display:flex;flex-direction:column;justify-content:flex-start;align-items:center;gap:15px}section[_ngcontent-%COMP%]   #logo[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;padding-bottom:25px;gap:10px}section[_ngcontent-%COMP%]   #logo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:40px;color:var(--theme-secondary)}section[_ngcontent-%COMP%]   #logo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{text-transform:uppercase;font-family:Figtree;font-size:20px;color:var(--theme--input-text)}section[_ngcontent-%COMP%]   .error-area[_ngcontent-%COMP%]{width:400px;padding:1rem;background:var(--theme-error-clear-opacity);color:var(--theme-error-dark);border-radius:3px}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]{width:400px;border:1px solid var(--theme-dark-clear);border-radius:12px;overflow:hidden}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]{display:flex;flex-direction:row}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .input[_ngcontent-%COMP%]   app-floating-label-input[_ngcontent-%COMP%]{flex:2}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .separator[_ngcontent-%COMP%]{border-top:1px solid var(--theme-dark-clear)}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{min-width:56px;width:56px;height:56px;display:flex;flex-direction:column;justify-content:center;align-items:center;color:var(--theme-label-text);cursor:pointer;transition:all ease .3s}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:30px;height:30px;display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:13px}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{background:var(--theme-standard-bg-hover);color:var(--theme-dark-bg-pan)}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .un-clickable[_ngcontent-%COMP%]{cursor:default;color:var(--theme-standard-grey-1)}section[_ngcontent-%COMP%]   .form-area[_ngcontent-%COMP%]   .un-clickable[_ngcontent-%COMP%]:hover{background:var(--theme-white);color:var(--theme-standard-grey-1)}footer[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;text-transform:uppercase;padding:1rem;height:80px;background:var(--theme-standard-bg);color:var(--theme-label-text);font-weight:600;font-size:10px}"]})}return o})()},8839:(M,u,r)=>{r.r(u),r.d(u,{SignInPageComponent:()=>p});var t=r(177),i=r(9417),l=r(4539),e=r(3300),g=r(4438);let p=(()=>{class m{constructor(){this.formGroupControls=(0,e.J)()}static#t=this.\u0275fac=function(f){return new(f||m)};static#e=this.\u0275cmp=g.VBU({type:m,selectors:[["app-sign-in-page"]],standalone:!0,features:[g.aNF],decls:1,vars:1,consts:[[3,"formGroupControls"]],template:function(f,a){1&f&&g.nrm(0,"app-security-form",0),2&f&&g.Y8G("formGroupControls",a.formGroupControls)},dependencies:[t.MD,i.X1,l.k]})}return m})()},8016:(M,u,r)=>{r.d(u,{h:()=>p});var t=r(6748),i=r(7461),l=r(3834),e=r(9417),g=r(4438);let p=(()=>{class m{getEmpty(){return{facebookHash:"",googleHash:"",id:"",isAdmin:!1,isEmpty:!0,mail:"",str:"",username:"",firstname:"",lastname:"",section:t.wn.WOOD}}fromDTO(n){return{facebookHash:"",googleHash:"",id:n.credential_id,isAdmin:n.isAdmin,isEmpty:!1,mail:n.mail,str:`${n.username.substring(0,1).toUpperCase()}${n.username.substring(1,n.username.length)}`,username:n.username,section:n.section,firstname:n.firstname,lastname:n.lastname}}fromDTOS(n){return n.map(f=>this.fromDTO(f))}toDTO(n){return{facebookHash:n.facebookHash,googleHash:n.googleHash,credential_id:n.id,isAdmin:n.isAdmin,mail:n.mail,username:n.username,firstname:n.firstname,lastname:n.lastname,section:n.section}}getDataTableConfig(n,f){let a=[];return f&&(a.push({icon:"fa-solid fa-pencil",action:i.lm.EDIT}),a.push({icon:"fa-solid fa-trash",action:i.lm.DELETE})),{translateKey:"admin-feature-member.table.label.",data:n,cellDefinitions:[{targetData:i.A2.USERNAME,minimalWidthVisibility:l.s5.SMALL,isMinimalWidth:!1},{targetData:i.A2.MAIL,minimalWidthVisibility:l.s5.MEDIUM,isMinimalWidth:!1},{targetData:i.A2.ISADMIN,minimalWidthVisibility:l.s5.MEDIUM,isMinimalWidth:!1},{targetData:"",actions:a,minimalWidthVisibility:l.s5.SMALL,isMinimalWidth:!0}]}}getDataFormConfig(n,f){const a=Object.values(i.A2),s=a.map(E=>{let d=[];switch(E){case i.A2.USERNAME:case i.A2.PASSWORD:d.push(e.k0.required,e.k0.minLength(3));break;case i.A2.MAIL:d.push(e.k0.required,e.k0.email);break;case i.A2.FIRSTNAME:case i.A2.LASTNAME:d.push(e.k0.required,e.k0.minLength(2));break;case i.A2.ISADMIN:case i.A2.SECTION:d.push(e.k0.required)}return{field:E,validators:d}}),v=a.map(E=>{let d="text",T=[];return E===i.A2.SECTION?(d="select",T=Object.values(t.wn).map(o=>({selected:n.section===o,value:o,label:`app.common.section.${o.toLowerCase()}`}))):E===i.A2.ISADMIN&&(d="select",T=Object.values(i.L7).map(o=>({selected:n.isAdmin===this.stringToBoolean(o),value:o,label:`feature.member.isAdmin.${o.toLowerCase()}`}))),{field:E,type:d,options:T}});return{submitTitle:f,translateKey:"feature.credential.form.label.",data:n,fields:a,validators:s,fieldTypes:v}}genCreatePayload(n){return{username:n.username,password:n.password,mail:n.mail,isAdmin:n.isAdmin,section:n.section,firstname:n.firstname,lastname:n.lastname}}genUpdatePayload(n){return{...this.genCreatePayload(n),credential_id:n.id}}stringToBoolean(n){return"true"===n.toLowerCase()}static#t=this.\u0275fac=function(f){return new(f||m)};static#e=this.\u0275prov=g.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}return m})()},8994:(M,u,r)=>{r.d(u,{i:()=>O});var t=r(4438),i=r(8141),l=r(6354),e=r(5323),g=r(6970),p=r(3834),m=r(8016);let O=(()=>{class n{constructor(){this.api=(0,t.WQX)(e.Gf),this.tokenService=(0,t.WQX)(e.By),this.isAuthenticated$=(0,t.EWP)(()=>!this.tokenService.token$().isEmpty),this.credentialUtil=(0,t.WQX)(m.h),this.account$=(0,t.vPA)(this.credentialUtil.getEmpty()),this.isAuthenticatedHandler=(0,t.QZP)(()=>this.handleAuthenticatedChange(this.isAuthenticated$())),this.router=(0,t.WQX)(g.Ix),this.list$=(0,t.vPA)([])}signIn(a){return this.api.post(e.XI.SIGN_IN,{...a,socialLogin:!1}).pipe((0,i.M)(s=>{s.result&&this.tokenService.setToken({...s.data,isEmpty:!1})}))}signUp(a){return this.api.post(e.XI.SIGN_UP,{...a,socialLogin:!1}).pipe((0,i.M)(s=>{s.result&&this.router.navigate([p.Av.REDIRECT_TO_PUBLIC]).then()}))}create(a){return this.api.post(e.XI.MEMBER_CREATE,a,!0).pipe((0,i.M)(s=>{s.result&&this.router.navigate([p.Av.REDIRECT_TO_MEMBER_LIST]).then()}),(0,l.T)(s=>s.result?this.credentialUtil.fromDTO(s.data):this.credentialUtil.getEmpty()))}update(a){return this.api.put(e.XI.MEMBER_UPDATE,a,!0).pipe((0,i.M)(s=>{s.result&&this.router.navigate([p.Av.REDIRECT_TO_MEMBER_LIST]).then()}),(0,l.T)(s=>s.result?this.credentialUtil.fromDTO(s.data):this.credentialUtil.getEmpty()))}logOut(){this.tokenService.setToken({token:"",refreshToken:"",isEmpty:!0})}handleAuthenticatedChange(a){this.api.get(e.XI.ME).pipe((0,i.M)(s=>{s.result?(this.account$.set(this.credentialUtil.fromDTO(s.data)),window.location.pathname.startsWith("/"+p.Av.REDIRECT_TO_AUTHENTICATED)||this.router.navigate([p.Av.REDIRECT_TO_AUTHENTICATED]).then()):this.router.navigate([p.Av.REDIRECT_TO_PUBLIC]).then()})).subscribe()}list(){this.api.get(e.XI.CREDENTIAL_LIST).pipe((0,i.M)(a=>{this.list$.set(a.result?this.credentialUtil.fromDTOS(a.data):[])})).subscribe()}detail(a){return this.api.get(`${e.XI.MEMBER_DETAIL}${a}`).pipe((0,l.T)(s=>s.result?this.credentialUtil.fromDTO(s.data):this.credentialUtil.getEmpty()))}delete(a){this.api.delete(`${e.XI.MEMBER_DELETE}${a}`,!0).pipe((0,i.M)(s=>{s.result&&this.list()})).subscribe()}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})()},382:(M,u,r)=>{r.d(u,{O:()=>t});var t=function(i){return i.SIGN_IN="signIn",i.SIGN_UP="signUp",i}(t||{})},3300:(M,u,r)=>{r.d(u,{J:()=>m,a:()=>O});var t=r(3834),i=r(9417);const l=new i.MJ("",[i.k0.required,i.k0.minLength(1),i.k0.maxLength(10)]),e=new i.MJ("",[i.k0.required]),g=new i.MJ("",[i.k0.required,(0,t.eO)("password")]),p=new i.MJ("",[i.k0.required]),m=()=>[{label:"Identifiant",formControl:l,input:"username",inputType:t.NZ.TEXT},{label:"Mot de passe",formControl:e,input:"password",inputType:t.NZ.PASSWORD}],O=()=>[{label:"Identifiant",formControl:l,input:"username",inputType:t.NZ.TEXT},{label:"Mot de passe",formControl:e,input:"password",inputType:t.NZ.PASSWORD},{label:"Confirmation",formControl:g,input:"confirmation",inputType:t.NZ.PASSWORD},{label:"Mail",formControl:p,input:"mail",inputType:t.NZ.TEXT}]}}]);